{namespace sic=SICOR\SicAddress\ViewHelpers}
<f:layout name="Default" />

<f:section name="content">
    <h2><f:translate key="BackendListTitle" /></h2>

    <div class="table-responsive">
        <table id="fieldEditor" class="table">
            <thead>
                <tr>
                    <th width="15%">DB Feld Name:</th>
                    <th width="15%">Beschriftung:</th>
                    <th width="25%">TCA Override:</th>
                    <th width="25%">Settings:</th>
                    <th width="10%">Teil des Labels:</th>
                    <th width="10%">Feldtyp:</th>
                    <th width="5%"></th>
                    <th width="5%"></th>
                </tr>
            </thead>
            <tbody>
            <f:if condition="{properties}">
                <f:then>
                    <f:for each="{properties}" as="property">
                        <f:form action="update" controller="DomainProperty" object="{property}" objectName="domainProperty">
                            <tr>
                                <td><f:form.textfield property="title" value="{property.title}" /></td>
                                <td><f:form.textfield property="tcaLabel" value="{property.label}" /></td>
                                <td><f:form.textarea property="tcaOverride" value="{property.tcaOverride}" /></td>
                                <td><f:form.textarea property="settings" value="{property.settings}" /></td>
                                <td><f:form.checkbox property="isListLabel" value="{f:if(condition: '{property.isListLabel} == true', then: 1, else: 0)}" /></td>
                                <td><f:form.select property="type" value="{property.type.title}" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></td>
                                <td><f:form.submit class="btn btn-success" value="Save" />
                                <td><f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action></td>
                            </tr>
                        </f:form>
                    </f:for>
                    <f:form id="createDomainTemplate" action="create" controller="DomainProperty" name="newDomainProperty" object="{newDomainProperty}" >
                        <tr>
                            <td><f:form.textfield property="title" value="" /></td>
                            <td><f:form.textfield property="tcaLabel" value="" /></td>
                            <td><f:form.textarea property="tcaOverride" value="" /></td>
                            <td><f:form.textarea property="settings" value="" /></td>
                            <td><f:form.checkbox property="isListLabel" value="0" /></td>
                            <td><f:form.select property="type" value="" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></td>
                            <td><f:form.submit class="btn btn-success" value="Save">Save</f:form.submit></td>
                            <td><f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action></td>
                        </tr>
                    </f:form>
                </f:then>
                <f:else>
                    <f:form id="createDomainTemplate" action="create" controller="DomainProperty" name="newDomainProperty" object="{newDomainProperty}" >
                        <tr>
                            <td><f:form.textfield property="title" value="" /></td>
                            <td><f:form.textfield property="tcaLabel" value="" /></td>
                            <td><f:form.textarea property="tcaOverride" value="" /></td>
                            <td><f:form.textarea property="settings" value="" /></td>
                            <td><f:form.checkbox property="isListLabel" value="0" /></td>
                            <td><f:form.select property="type" value="" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></td>
                            <td><f:form.submit class="btn btn-success" value="Save">Save</f:form.submit></td>
                            <td><f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action></td>
                        </tr>
                    </f:form>
                </f:else>
            </f:if>
            </tbody>
        </table>
        <f:link.action class="btn btn-primary" action="create">Generate Model, TCA, i18n, DB</f:link.action>
    </div>

    <hr/>

    <h2><f:translate key="BackendImporterListTitle" /></h2>
    <f:form action="migrateNicosDirectory" controller="Import">
        <f:form.submit class="btn btn-default" value="Migrate Data from nicos_directory" />
    </f:form>

</f:section>
