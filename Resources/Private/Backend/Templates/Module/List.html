{namespace sic=SICOR\SicAddress\ViewHelpers}
<f:layout name="Default" />

<f:section name="content">
    <h2><f:translate key="BackendListTitle" /></h2>

    <div class="container-fluid table">
        <div class="row thead">
            <div class="col-sm-2 td">DB Feld:</div>
            <div class="col-sm-2 td">Beschriftung:</div>
            <div class="col-sm-2 td">TCA Override:</div>
            <div class="col-sm-2 td">Settings:</div>
            <div class="col-sm-1 td">Label:</div>
            <div class="col-sm-1 td">Feldtyp:</div>
            <div class="col-sm-2 td">Aktion:</div>
        </div>
        <f:if condition="{properties}">
            <f:then>
                <f:for each="{properties}" as="property">
                    <div class="row tr">
                        <f:form action="update" controller="DomainProperty" object="{property}" objectName="domainProperty">
                            <div class="col-sm-2 td"><f:form.textfield property="title" value="{property.title}" /></div>
                            <div class="col-sm-2 td"><f:form.textfield property="tcaLabel" value="{property.label}" /></div>
                            <div class="col-sm-2 td"><f:form.textarea property="tcaOverride" value="{property.tcaOverride}" /></div>
                            <div class="col-sm-2 td"><f:form.textarea property="settings" value="{property.settings}" /></div>
                            <div class="col-sm-1 td"><f:form.checkbox property="isListLabel" value="{f:if(condition: '{property.isListLabel} == true', then: 1, else: 0)}" /></div>
                            <div class="col-sm-1 td"><f:form.select property="type" value="{property.type.title}" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></div>
                            <div class="col-sm-2 td">
                                <f:form.submit class="btn btn-success" value="Save" />
                                <f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action>
                            </div>
                        </f:form>
                    </div>
                </f:for>
                <div class="row tr">
                    <f:form id="createDomainTemplate" action="create" controller="DomainProperty" name="newDomainProperty" object="{newDomainProperty}" >
                            <div class="col-sm-2 td"><f:form.textfield property="title" placeholder="DB Feld Name" /></div>
                            <div class="col-sm-2 td"><f:form.textfield property="tcaLabel" placeholder="Beschriftung" /></div>
                            <div class="col-sm-2 td"><f:form.textarea property="tcaOverride" placeholder="TCA Override"/></div>
                            <div class="col-sm-2 td"><f:form.textarea property="settings" placeholder="Settings" /></div>
                            <div class="col-sm-1 td"><f:form.checkbox property="isListLabel" value="" /></div>
                            <div class="col-sm-1 td"><f:form.select property="type" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></div>
                            <div class="col-sm-2 td">
                                <f:form.submit class="btn btn-success" value="Save" />
                                <f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action>
                            </div>
                    </f:form>
                </div>
            </f:then>
            <f:else>
                <div class="row tr">
                    <f:form id="createDomainTemplate" action="create" controller="DomainProperty" name="newDomainProperty" object="{newDomainProperty}" >
                        <div class="col-sm-2 td"><f:form.textfield property="title" placeholder="DB Feld Name" /></div>
                        <div class="col-sm-2 td"><f:form.textfield property="tcaLabel" placeholder="Beschriftung" /></div>
                        <div class="col-sm-2 td"><f:form.textarea property="tcaOverride" placeholder="TCA Override"/></div>
                        <div class="col-sm-2 td"><f:form.textarea property="settings" placeholder="Settings" /></div>
                        <div class="col-sm-1 td"><f:form.checkbox property="isListLabel" value="" /></div>
                        <div class="col-sm-1 td"><f:form.select property="type" options="{fieldTypes}" optionValueField="key" optionLabelField="value"/></div>
                        <div class="col-sm-2 td">
                            <f:form.submit class="btn btn-success" value="Save" />
                            <f:link.action class="btn btn-danger" action="delete" controller="DomainProperty" arguments="{domainProperty: property}">Delete</f:link.action>
                        </div>
                    </f:form>
                </div>
            </f:else>
        </f:if>
    </div>
    <hr />

    <div class="row">
        <div class="col-sm-2"><f:link.action class="btn btn-primary" action="create">Generate Model, TCA, i18n, DB</f:link.action></div>
        <div class="col-sm-2 col-sm-offset-8"><f:link.action class="btn btn-danger" action="removeAllDomainProperties">Clear Field Definition</f:link.action></div>
    </div>

    <h2><f:translate key="BackendImporterListTitle" /></h2>

    <f:form action="createTableMapping">
        <div class="row">
            <div class="col-sm-2"><f:form.textfield id="schemaName" name="schema" value="" placeholder="Name der Datenbank"/></div>
            <div class="col-sm-2"><f:form.submit class="btn btn-primary" value="Import tt_address Field Definition" /></div>
        </div>
    </f:form>

    <hr />

    <f:form action="migrateNicosDirectory" controller="Import">
        <f:form.submit class="btn btn-default" value="Migrate Data from nicos_directory" />
    </f:form>

</f:section>
